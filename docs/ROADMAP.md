# Valuemon (Shadow Lantern) 統合ロードマップ

> **最終更新**: 2025-12-29  
> **現在のフェーズ**: 知人フィードバック待ち → Phase 3.5へ

---

## 📊 現在の進行状況サマリー

```
┌─────────────────────────────────────────────────────────────┐
│  ████████████████████████████████░░░░░░░░░░  75% 完了      │
└─────────────────────────────────────────────────────────────┘

Phase 1: MVP ........................... ✅ 完了
Phase 2: Alpha ......................... ✅ 完了  
Phase 3: Beta .......................... ✅ 完了
Phase 3.5: Big5ソーシャル機能 ........... 📋 計画済み（未着手）
Phase 4: エンドコンテンツ ............... ⏳ 未着手
```

---

## ✅ 実装済み機能一覧

### 診断モジュール

| 機能 | ファイル | 状態 |
|-----|---------|------|
| シャドウ・プロファイリング | `/diagnosis/shadow/` | ✅ 完了 |
| バリューランタン | `/diagnosis/lantern/` | ✅ 完了 |
| アンフィニッシュドセンテンス | `/diagnosis/sentence/` | ✅ 完了 |
| CCI（6つの質問） | `/diagnosis/cci/` | ✅ 完了 |

### 育成・ゲーミフィケーション

| 機能 | ファイル | 状態 |
|-----|---------|------|
| モンスター育成 | `monsterStore.ts`, `HabitMonster.tsx` | ✅ 完了 |
| バリュースピリット | `valueSpiritStore.ts`, `ValueSpirit.tsx` | ✅ 完了 |
| 6段階進化システム | `valueSpiritStore.ts` | ✅ 完了 |
| コレクション | `/collection/`, `collectionStore.ts` | ✅ 完了 |

### 習慣化・継続支援

| 機能 | ファイル | 状態 |
|-----|---------|------|
| 習慣管理 | `/habit/`, `habitStore.ts`, `HabitCard.tsx` | ✅ 完了 |
| 今日のアクション | `TodayAction.tsx` | ✅ 完了 |
| リフレクション | `/reflection/`, `reflectionStore.ts`, `ReflectionModal.tsx` | ✅ 完了 |
| 行動ログ | `actionLogStore.ts` | ✅ 完了 |
| 障害対策計画 | `ObstacleModal.tsx`, `/api/obstacle-plan/` | ✅ 完了 |

### API連携

| 機能 | ファイル | 状態 |
|-----|---------|------|
| シャドウ分析 | `/api/analyze/` | ✅ 完了 |
| CCI分析 | `/api/analyze-cci/` | ✅ 完了 |
| センテンス分析 | `/api/analyze-sentence/` | ✅ 完了 |
| チャット | `/api/chat/` | ✅ 完了 |

### UI/UXコンポーネント

| 機能 | ファイル | 状態 |
|-----|---------|------|
| ボトムナビゲーション | `BottomNav.tsx` | ✅ 完了 |
| ランタン表示 | `Lantern.tsx` | ✅ 完了 |
| バリューカード | `ValueCard.tsx` | ✅ 完了 |
| ミスティカルUI | `MysticalButton.tsx`, `MysticalCard.tsx` | ✅ 完了 |
| シャドウクレンズ | `ShadowCleanse.tsx` | ✅ 完了 |
| カードフレーム | `ui/CardFrame.tsx` | ✅ 完了 |

---

## 🚧 未実装・保留中機能

### Phase 3.5: Big5ソーシャル機能 📋

> **詳細**: [FUTURE_SOCIAL_FEATURES_PLAN.md](./FUTURE_SOCIAL_FEATURES_PLAN.md)

| 機能 | 優先度 | 状態 |
|-----|-------|------|
| TIPI-J診断UI | 高 | 📋 計画済み |
| 進化連動Big5収集（10問×5段階） | 高 | 📋 計画済み |
| Supabaseスキーマ設計 | 高 | 📋 計画済み |
| 匿名アイデア共有 | 中 | 📋 計画済み |
| マッチングアルゴリズム | 中 | 📋 計画済み |
| いいね・コメント機能 | 低 | 📋 計画済み |

### Phase 4: エンドコンテンツ ⏳

| 機能 | 説明 | 状態 |
|-----|------|------|
| ~~モンスター配合~~ | ~~2体のモンスターを掛け合わせ高次テーマ生成~~ | ❌ 方向性変更により削除 |
| 成長記録図鑑 | 習慣・目標の成功/失敗/リカバリーを可視化 | 📋 計画済み |
| チームランタン | 複数ユーザーでの協力機能 | ⏳ 未着手 |
| スキルシステム拡張 | 追加スキル実装 | ⏳ 未着手 |

---

## 📖 新機能詳細: 成長記録図鑑

> **コンセプト**: モンスターは「ご褒美」であり、メインは**自分の成長の軌跡を可視化・振り返る**こと

### 設計思想

```
従来の方向: モンスター育成RPG → モンスターが主役
新しい方向: 自己成長ジャーナル → 自分が主役、モンスターはご褒美
```

### 図鑑に記録される情報

| カテゴリ | 記録内容 |
|---------|---------|
| **習慣ログ** | 実行回数、継続日数、最長ストリーク |
| **目標進捗** | 目標達成率、マイルストーン |
| **失敗と学び** | うまくいかなかった状況、その時の気持ち |
| **工夫・改善** | どう改善したか、何を変えたか |
| **リカバリー記録** | サボってから何日で復帰したか、その時の気持ち |
| **感情ログ** | 各記録時点での気持ち |

### 画面イメージ

```
┌─────────────────────────────────────────────────┐
│  📖 成長記録図鑑                                │
├─────────────────────────────────────────────────┤
│                                                 │
│  ┌───────────────────────────────────────────┐ │
│  │ 🎯 習慣: 毎朝5分瞑想                       │ │
│  │                                           │ │
│  │ 📊 累計実行: 47回 | 継続中: 12日           │ │
│  │ 🏆 最長ストリーク: 21日                    │ │
│  │                                           │ │
│  │ 📅 タイムライン ─────────────────────     │ │
│  │ 12/29 ✅ 達成 「気分スッキリ」              │ │
│  │ 12/28 ✅ 達成                              │ │
│  │ 12/25 ❌ 失敗 「寝坊して時間なかった」       │ │
│  │        → 改善: 夜に準備するようにした      │ │
│  │ 12/20 🔄 リカバリー（3日ぶり）              │ │
│  │        「落ち込んでいたけど再開できた」     │ │
│  │                                           │ │
│  └───────────────────────────────────────────┘ │
│                                                 │
│  ┌───────────────────────────────────────────┐ │
│  │ 📈 全体サマリー                           │ │
│  │ 平均リカバリー日数: 2.3日                  │ │
│  │ 最も多い失敗パターン: 朝の時間不足         │ │
│  │ 最も効果的だった工夫: 前日準備             │ │
│  └───────────────────────────────────────────┘ │
│                                                 │
└─────────────────────────────────────────────────┘
```

### データ構造（将来実装用）

```typescript
interface GrowthRecord {
  id: string;
  habitId: string;
  date: Date;
  type: 'success' | 'failure' | 'recovery' | 'milestone';
  
  // 成功時
  feeling?: string;          // その時の気持ち
  
  // 失敗時
  situation?: string;        // 状況
  obstacle?: string;         // 障害
  
  // リカバリー時
  daysToRecover?: number;    // 復帰までの日数
  recoveryFeeling?: string;  // 復帰時の気持ち
  
  // 改善・工夫
  improvement?: string;      // どう改善したか
  lesson?: string;           // 学んだこと
}

interface HabitSummary {
  habitId: string;
  totalExecutions: number;
  currentStreak: number;
  longestStreak: number;
  avgRecoveryDays: number;
  commonFailurePattern: string;
  mostEffectiveImprovement: string;
}
```

### 実装フェーズ

| フェーズ | 内容 |
|---------|------|
| Phase A | 基本ログ機能（成功/失敗の記録） |
| Phase B | 感情・状況の記録追加 |
| Phase C | 改善・工夫の記録追加 |
| Phase D | リカバリー追跡・分析 |
| Phase E | AIによるパターン分析・アドバイス |

---

## 🗑️ 削除・廃止された機能

| 機能 | 理由 | 代替案 |
|-----|------|--------|
| `/api/generate-quest/` | 空ディレクトリ、未実装のまま残存 | 習慣モジュールで代替 |
| `/api/acceptance/` | 空ディレクトリ、未実装のまま残存 | - |
| `/api/ai-feedback/` | 空ディレクトリ、未実装のまま残存 | `/api/chat/`で代替 |
| `/api/skill-execute/` | 空ディレクトリ、未実装のまま残存 | - |
| `/api/weekly-meaning/` | 空ディレクトリ、未実装のまま残存 | リフレクションで代替 |
| gameLoopStore.ts | 設計のみ、未実装 | 習慣+リフレクションで代替 |

---

## 📅 今後の実装スケジュール

### 直近（知人フィードバック後）

```
┌─────────────────────────────────────────────────────────────┐
│ Step 1: フィードバック収集・分析                             │
│   - 知人からのUX/UI改善点まとめ                              │
│   - 致命的なバグの修正                                       │
│   - 操作フローの再検討                                       │
└─────────────────────────────────────────────────────────────┘
           ↓
┌─────────────────────────────────────────────────────────────┐
│ Step 2: Big5進化連動システム                                 │
│   - モンスター進化時に10問ずつBig5質問を表示                  │
│   - 段階的なスコア算出                                       │
│   - ソーシャル機能段階的解放                                  │
└─────────────────────────────────────────────────────────────┘
           ↓
┌─────────────────────────────────────────────────────────────┐
│ Step 3: データベース移行                                     │
│   - ローカルストレージ → Supabase                            │
│   - ユーザー認証実装                                         │
│   - RLSポリシー設定                                          │
└─────────────────────────────────────────────────────────────┘
           ↓
┌─────────────────────────────────────────────────────────────┐
│ Step 4: ソーシャル機能MVP                                    │
│   - 匿名アイデア共有（読み取り専用）                          │
│   - Big5ベースフィルタリング                                  │
└─────────────────────────────────────────────────────────────┘
```

---

## 🛠️ 技術要件・依存関係

### 現在の技術スタック

| 項目 | 技術 |
|-----|------|
| フロントエンド | Next.js 14 (App Router) |
| スタイリング | CSS (globals.css) |
| 状態管理 | Zustand |
| AI | Google Gemini API |
| 認証（予定） | Supabase Auth |
| DB（予定） | Supabase PostgreSQL |
| デプロイ | Vercel |

### 必要な環境変数

```env
GOOGLE_API_KEY=      # Gemini API
NEXT_PUBLIC_SUPABASE_URL=     # （将来）
NEXT_PUBLIC_SUPABASE_ANON_KEY=  # （将来）
```

---

## 📁 ディレクトリ構造（主要部分）

```
/Users/yo-hey/Valuemon/
├── app/src/
│   ├── app/                    # ページ
│   │   ├── page.tsx            # ホーム
│   │   ├── diagnosis/          # 診断モジュール
│   │   │   ├── shadow/         # シャドウ・プロファイリング
│   │   │   ├── lantern/        # バリューランタン
│   │   │   ├── sentence/       # アンフィニッシュドセンテンス
│   │   │   └── cci/            # 6つの質問
│   │   ├── habit/              # 習慣管理
│   │   ├── collection/         # コレクション
│   │   ├── reflection/         # リフレクション
│   │   ├── lantern/            # ランタン表示
│   │   └── api/                # APIエンドポイント
│   ├── components/             # UIコンポーネント
│   ├── stores/                 # Zustand状態管理
│   ├── data/                   # 静的データ
│   └── types/                  # TypeScript型定義
├── docs/
│   ├── DESIGN_DOCUMENT.md      # 詳細設計書
│   ├── FUTURE_SOCIAL_FEATURES_PLAN.md  # Big5ソーシャル計画
│   └── ROADMAP.md              # ← このファイル
└── supabase/                   # DB設定（将来）
```

---

## 🎯 中長期ビジョン

### 1年目目標

1. **個人向け価値観診断ツール**として確立
2. **習慣化支援**機能の完成
3. **ソーシャル機能**MVP

### 2年目以降

1. **マッチング機能**（異なる価値観の人との出会い）
2. **チーム/組織向け**機能
3. **BtoB展開**（企業の価値観研修ツール）

---

## 📝 参考ドキュメント

| ドキュメント | 説明 |
|------------|------|
| [DESIGN_DOCUMENT.md](./DESIGN_DOCUMENT.md) | 詳細設計書（心理学的基盤、システム設計） |
| [FUTURE_SOCIAL_FEATURES_PLAN.md](./FUTURE_SOCIAL_FEATURES_PLAN.md) | Big5ソーシャル機能計画 |
| [AI_PROMPTS.md](./AI_PROMPTS.md) | AIプロンプト集 |

---

> 📌 **Next Action**: 知人フィードバック → Step 1から順次実装
